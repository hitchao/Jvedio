<chao:BaseWindow
    x:Class="Jvedio.Window_MetaDatas"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:chao="https://gitee.com/secret/chao-controls"
    xmlns:cmd="clr-namespace:Jvedio.Core.Command"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:ext="clr-namespace:Jvedio.Core.Extensions"
    xmlns:fa="http://schemas.fontawesome.io/icons/"
    xmlns:hc="https://handyorg.github.io/handycontrol"
    xmlns:lang="clr-namespace:Jvedio.Language;assembly=Jvedio.Language"
    xmlns:local="clr-namespace:Jvedio"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:p="clr-namespace:Jvedio.Properties"
    xmlns:usercontrol="clr-namespace:Jvedio.Style.UserControls;assembly=Jvedio.Style"
    Title="Jvedio"
    Width="1100"
    Height="600"
    MinWidth="800"
    MinHeight="500"
    Background="{DynamicResource Global.Background}"
    CanMinimized="True"
    CanResize="True"
    Closing="BaseWindow_Closing"
    ContentRendered="BaseWindow_ContentRendered"
    Foreground="{DynamicResource Global.Foreground}"
    Icon="pack://application:,,,/Resources/Jvedio.ico"
    TitleAlign="Left"
    TitleMargin="5 0"
    WindowStartupLocation="CenterScreen"
    mc:Ignorable="d">

    <chao:BaseWindow.Resources>

        <!--  高清、中字、流出  -->

        <local:TagStampsConverter x:Key="TagStampsConverter" />
        <!--<local:MovieStampTypeToVisibilityConverter x:Key="MovieStampTypeToVisibilityConverter" />-->
        <local:NullToVisibilityConverter x:Key="NullToVisibilityConverter" />
        <local:NotEqualConverter x:Key="NotEqualConverter" />
        <local:MultiLargerConverter x:Key="MultiLargerConverter" />
        <local:MultiUnitConverter x:Key="MultiUnitConverter" />
        <local:LargerThanVisibilityConverter x:Key="LargerThanVisibilityConverter" />
        <!--<local:LargerThanConverter x:Key="LargerThanConverter" />-->


        <Style
            x:Key="SearchBoxListItemContainerStyle"
            BasedOn="{StaticResource NormalListBoxItem}"
            TargetType="{x:Type ListBoxItem}">
            <Setter Property="Margin" Value="0" />
            <Setter Property="Padding" Value="5" />
            <Setter Property="FontSize" Value="14" />

        </Style>




        <Style
            x:Key="InfoItemStyle"
            BasedOn="{StaticResource FlatListBoxItem}"
            TargetType="{x:Type ListBoxItem}">
            <Setter Property="Margin" Value="0" />
            <Setter Property="Padding" Value="0" />
            <Setter Property="Background" Value="Red" />
            <!--<Setter Property="ContentTemplate" Value="{StaticResource ListTemplate}" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType={x:Type Window}}, Path=DataContext.Tile, FallbackValue=False}" Value="True">
                    <Setter Property="ContentTemplate" Value="{StaticResource TileTemplate}" />
                </DataTrigger>
            </Style.Triggers>-->
        </Style>


        <Style x:Key="HoverSpliter" TargetType="GridSplitter">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Margin" Value="0" />
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Trigger.EnterActions>
                        <BeginStoryboard>
                            <Storyboard FillBehavior="HoldEnd">
                                <ColorAnimation
                                    Storyboard.TargetProperty="Background.Color"
                                    To="#007FD4"
                                    Duration="0:0:0.2" />
                            </Storyboard>
                        </BeginStoryboard>
                    </Trigger.EnterActions>
                    <Trigger.ExitActions>
                        <BeginStoryboard>
                            <Storyboard>
                                <ColorAnimation
                                    Storyboard.TargetProperty="Background.Color"
                                    To="Transparent"
                                    Duration="0:0:0.2" />
                            </Storyboard>
                        </BeginStoryboard>
                    </Trigger.ExitActions>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style
            x:Key="ActorInfoTextBlock"
            BasedOn="{StaticResource BaseTextBlock}"
            TargetType="{x:Type TextBlock}">
            <Setter Property="Margin" Value="10,10" />
        </Style>



        <Style
            x:Key="ActorTextBox"
            BasedOn="{StaticResource ReadOnlyWrapTextBox}"
            TargetType="{x:Type TextBox}">
            <Setter Property="Width" Value="100" />
            <Setter Property="TextAlignment" Value="Left" />
            <Setter Property="FontSize" Value="15" />
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="ContextMenu" Value="{StaticResource TextBoxContextMenu}" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding EnableEditActress}" Value="True">
                    <Setter Property="Background" Value="{DynamicResource Window.Side.Background}" />
                    <Setter Property="IsReadOnly" Value="False" />
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <Style
            x:Key="MenuButton"
            BasedOn="{StaticResource HoverButton}"
            TargetType="{x:Type Button}">
            <Setter Property="Height" Value="40" />
        </Style>

        <Style x:Key="GifImageStyle" TargetType="{x:Type local:GifImage}">
            <Style.Triggers>

                <DataTrigger Binding="{Binding ShowImageMode, Mode=OneWay, Source={x:Static p:Settings.Default}}" Value="1">
                    <Setter Property="SourceType" Value="BigImage" />
                    <Setter Property="Width" Value="{Binding BigImage_Width, Source={x:Static p:Settings.Default}, Mode=OneWay}" />
                    <Setter Property="Height" Value="{Binding BigImage_Height, Source={x:Static p:Settings.Default}, Mode=OneWay}" />
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <Style
            x:Key="CenterTextBlock"
            BasedOn="{StaticResource BaseTextBlock}"
            TargetType="{x:Type TextBlock}">
            <Setter Property="Padding" Value="5" />
            <Setter Property="Margin" Value="5" />
            <Setter Property="TextAlignment" Value="Center" />
            <Setter Property="FontSize" Value="20" />
        </Style>


        <Style
            x:Key="ActorBorder"
            BasedOn="{StaticResource SimpleBorder}"
            TargetType="{x:Type Border}">
            <Style.Triggers>
                <MultiDataTrigger>
                    <MultiDataTrigger.Conditions>
                        <Condition Binding="{Binding ActorEditMode, Mode=OneWay, Source={x:Static p:Settings.Default}}" Value="True" />
                        <Condition Binding="{Binding IsMouseOver, RelativeSource={RelativeSource Mode=Self}}" Value="True" />
                    </MultiDataTrigger.Conditions>
                    <Setter Property="BorderBrush" Value="{DynamicResource Selected_BorderBrush}" />
                </MultiDataTrigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="HoverCanvas" TargetType="{x:Type Canvas}">
            <Setter Property="Visibility" Value="Hidden" />
            <Style.Triggers>
                <MultiDataTrigger>
                    <MultiDataTrigger.Conditions>
                        <Condition Binding="{Binding EditMode, Mode=TwoWay, Source={x:Static p:Settings.Default}}" Value="False" />
                        <Condition Binding="{Binding IsMouseOver, RelativeSource={RelativeSource AncestorType={x:Type Grid}, Mode=FindAncestor}}" Value="True" />
                    </MultiDataTrigger.Conditions>
                    <Setter Property="Visibility" Value="Visible" />
                </MultiDataTrigger>
                <DataTrigger Binding="{Binding EditMode, Mode=TwoWay, Source={x:Static p:Settings.Default}}" Value="True">
                    <Setter Property="Visibility" Value="Hidden" />
                </DataTrigger>
            </Style.Triggers>
        </Style>


    </chao:BaseWindow.Resources>


    <Grid AllowDrop="True">
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="auto" />
        </Grid.RowDefinitions>

        <Grid Margin="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition
                    Name="SideGridColumn"
                    Width="{Binding SideGridWidth, FallbackValue=200, Mode=OneWay}"
                    MinWidth="100"
                    MaxWidth="500" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <!--  侧边栏  -->
            <Border
                x:Name="SideBorder"
                Grid.Column="0"
                MinWidth="100"
                Background="{DynamicResource Window.Side.Background}"
                SizeChanged="SideBorder_SizeChanged">
                <Grid SizeChanged="Grid_SizeChanged">

                    <Grid.RowDefinitions>
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <Grid Grid.Row="0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <Border
                            Grid.Column="0"
                            Margin="5"
                            VerticalAlignment="Center"
                            MouseLeftButtonDown="GoToStartUp"
                            Style="{StaticResource RoundBorder}"
                            Tag="{DynamicResource Window.Title.Hover.Background}"
                            ToolTip="返回">
                            <Viewbox Width="auto" Height="14">
                                <Path
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Data="M795.91835938 490.13457031c-49.66523437-60.0609375-111.53320313-102.77578125-179.10878907-123.73857422a439.74755859 439.74755859 0 0 0-102.54902344-19.37988281V162.25859375a30.79335937 30.79335937 0 0 0-11.46972656-27.40429688c-7.91015625-5.47910156-17.74160156-4.12382812-24.40898437 3.27832032L139.31914062 448.32324219a35.08769531 35.08769531 0 0 0-8.92792968 23.33496093c0 9.4359375 3.84257812 18.24960937 10.28320312 23.39121094l340.41972657 312.50742188a17.96748047 17.96748047 0 0 0 23.10820312 3.27832031 32.60039063 32.60039063 0 0 0 11.41347656-27.34804688v-174.3046875c128.03203125 4.63183594 213.74472656 49.77773437 273.80390625 130.0078125 28.81582031 36.66972656 49.94824219 81.36210937 61.47421875 130.29257813 2.71142578 13.78652344 12.825 23.50371094 24.40898438 23.39121094h2.48554687c12.20449219-1.29902344 21.58242187-13.73027344 21.75292969-28.75957032 1.35527344-159.33339844-33.22265625-284.65136719-103.62304688-374.26289062v0.22675781z"
                                    Fill="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}" />
                            </Viewbox>
                        </Border>


                        <ComboBox
                            x:Name="DatabaseComboBox"
                            Grid.Column="1"
                            Height="30"
                            Margin="5"
                            HorizontalAlignment="Stretch"
                            Background="{DynamicResource Window.Side.Background}"
                            BorderBrush="{DynamicResource Window.Side.Hover.Background}"
                            DisplayMemberPath="Name"
                            FontSize="16"
                            Foreground="{DynamicResource Global.Foreground}"
                            ItemContainerStyle="{StaticResource BaseComboBoxItemStyle}"
                            ItemsSource="{Binding DataBases}"
                            SelectedValuePath="DBId"
                            Style="{StaticResource NormalComboBox}"
                            Tag="{DynamicResource Window.Side.Hover.Background}"
                            ToolTip="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Text}" />
                    </Grid>
                    <!--<Button
                        Grid.Row="0"
                        Margin="10,5"
                        HorizontalAlignment="Stretch"
                        Click="GoToStartUp"
                        Content="返回选择" />

                    <ComboBox
                        x:Name="DatabaseComboBox"
                        Grid.Row="1"
                        Height="30"
                        Margin="5"
                        HorizontalAlignment="Stretch"
                        Background="{DynamicResource Window.Side.Background}"
                        BorderBrush="{DynamicResource Window.Side.Hover.Background}"
                        DisplayMemberPath="Name"
                        FontSize="16"
                        Foreground="{DynamicResource Global.Foreground}"
                        ItemContainerStyle="{StaticResource BaseComboBoxItemStyle}"
                        ItemsSource="{Binding DataBases}"
                        SelectedValuePath="DBId"
                        Style="{StaticResource NormalComboBox}"
                        Tag="{DynamicResource Window.Side.Hover.Background}"
                        ToolTip="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Text}" />-->
                    <chao:TogglePanel
                        Grid.Row="2"
                        Padding="0,5"
                        FontSize="15"
                        Header="默认"
                        IsExpanded="True"
                        IsSelected="False"
                        LineWidth="0"
                        Style="{StaticResource BaseTogglePanel}">
                        <StackPanel Height="auto" VerticalAlignment="Stretch">
                            <chao:PathRadioButton
                                Name="AllRadioButton"
                                Command="{Binding SelectCommand}"
                                CommandParameter="All"
                                MainText="所有资源"
                                Path="M63.465962 793.139052c0 55.038524 44.620243 99.708909 99.709933 99.708909l697.969529 0c55.04057 0 99.709933-44.669362 99.709933-99.708909L960.855356 194.878432c0-55.089689-44.669362-99.709933-99.709933-99.709933L163.174871 95.1685c-55.089689 0-99.709933 44.620243-99.709933 99.709933L63.464939 793.139052zM761.435491 494.00823 362.59576 743.283574 362.59576 244.732887 761.435491 494.00823z"
                                Style="{StaticResource BasePathRadioButton}"
                                SubText="{Binding AllDataCount}" />
                            <chao:PathRadioButton
                                Command="{Binding SelectCommand}"
                                CommandParameter="Favorite"
                                MainText="{x:Static lang:Resources.Favorites}"
                                Path="M335.008 916.629333c-35.914667 22.314667-82.88 10.773333-104.693333-25.557333a77.333333 77.333333 0 0 1-8.96-57.429333l46.485333-198.24a13.141333 13.141333 0 0 0-4.021333-12.864l-152.16-132.586667c-31.605333-27.52-35.253333-75.648-8.234667-107.733333a75.68 75.68 0 0 1 51.733333-26.752L354.848 339.2c4.352-0.362667 8.245333-3.232 10.026667-7.594667l76.938666-188.170666c16.032-39.2 60.618667-57.92 99.52-41.461334a76.309333 76.309333 0 0 1 40.832 41.461334l76.938667 188.16c1.781333 4.373333 5.674667 7.253333 10.026667 7.605333l199.712 16.277333c41.877333 3.413333 72.885333 40.458667 69.568 82.517334a76.938667 76.938667 0 0 1-26.08 51.978666l-152.16 132.586667c-3.541333 3.082667-5.141333 8.074667-4.021334 12.853333l46.485334 198.24c9.621333 41.013333-15.36 82.336-56.138667 92.224a75.285333 75.285333 0 0 1-57.525333-9.237333l-170.976-106.24a11.296 11.296 0 0 0-12.010667 0l-170.986667 106.24z"
                                Style="{StaticResource BasePathRadioButton}"
                                SubText="{Binding FavoriteCount}" />
                            <chao:PathRadioButton
                                Command="{Binding SelectCommand}"
                                CommandParameter="RecentView"
                                MainText="{x:Static lang:Resources.RecentView}"
                                Path="M514.941447 890.533617c75.021176-0.60418 145.170347-21.660501 204.945616-58.36123l65.26431 98.08286a509.889473 509.889473 0 0 1-270.209926 77.026541C235.59169 1007.281788 9.306945 783.413764 9.306945 507.791926 9.306945 232.170089 235.59169 8.302065 514.941447 8.302065c279.966793 0 506.868572 223.868024 506.868572 499.489861 0 7.828632 0 15.040229-0.617035 22.868861l-118.933503-1.20836c0.60418-7.211597 0.60418-13.831869 0.60418-21.056321 0-211.231661-173.823912-382.150366-387.922214-382.150365-214.085448 0-387.318034 171.522885-387.318034 382.150365s173.232586 382.137511 387.318034 382.137511z m444.046693-194.378891L820.528049 514.219374h276.303147L958.975285 696.154726zM696.09265 529.452427c-4.884861 9.641172-14.654582 19.860815-24.411449 29.489133l-176.883377 101.707941c-34.15546 19.256635-78.671967 9.628318-98.198555-24.077221-4.884861-9.628318-9.756867-24.064366-10.965226-33.692684V394.051801c1.20836-38.51327 30.491815-72.822989 75.008321-72.822989 14.654582 0 24.398594 4.820586 34.15546 9.641173l176.883377 101.695086c34.168315 19.256635 44.529362 63.194672 24.398594 96.887356z"
                                Style="{StaticResource BasePathRadioButton}"
                                SubText="{Binding RecentViewCount}">
                                <chao:PathRadioButton.ContextMenu>
                                    <ContextMenu>
                                        <MenuItem Header="{x:Static lang:Resources.Clear}" />
                                    </ContextMenu>
                                </chao:PathRadioButton.ContextMenu>
                            </chao:PathRadioButton>

                            <chao:PathRadioButton
                                Command="{Binding ShowLabelsCommand}"
                                IsEnabled="False"
                                MainText="我的标签"
                                Path="M1009.37559 308.860541l-279.669985-271.075961a136.280853 136.280853 0 0 0-186.679716-1.544011L8.27357 534.460996a25.898606 25.898606 0 0 0-8.215305 20.043015v339.420313a129.900882 129.900882 0 0 0 129.75522 129.959147h351.189758a26.044267 26.044267 0 0 0 18.586401-7.807454l512.11653-523.390725a129.667824 129.667824 0 0 0-2.330584-183.824751zM279.932176 874.318293a116.529161 116.529161 0 1 1 116.529161-116.529161 116.529161 116.529161 0 0 1-116.529161 116.529161z"
                                Style="{StaticResource BasePathRadioButton}"
                                SubText="{Binding AllLabelCount}" />

                        </StackPanel>
                    </chao:TogglePanel>

                    <Grid Grid.Row="3">

                        <Border
                            Margin="5"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Top"
                            Panel.ZIndex="6"
                            Style="{StaticResource RoundBorder}"
                            Tag="{DynamicResource Window.Title.Hover.Background}"
                            ToolTip="{x:Static lang:Resources.Add}">

                            <Viewbox Width="auto" Height="14">
                                <Path
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Data="M867.7 423.8H599.8V155.9c0-49.3-40-89.3-89.3-89.3s-89.3 40-89.3 89.3v267.9H153.3c-49.3 0-89.3 40-89.3 89.3s40 89.3 89.3 89.3h267.9v267.9c0 49.3 40 89.3 89.3 89.3s89.3-40 89.3-89.3V602.4h267.9c49.3 0 89.3-40 89.3-89.3s-40-89.3-89.3-89.3z"
                                    Fill="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}" />
                            </Viewbox>
                        </Border>
                        <chao:TogglePanel
                            Padding="0,5"
                            FontSize="15"
                            Header="标记"
                            IsEnabled="False"
                            IsExpanded="True"
                            IsSelected="False"
                            LineWidth="0"
                            Style="{StaticResource BaseTogglePanel}">
                            <StackPanel>

                                <ItemsControl
                                    x:Name="TagStampItemsControl"
                                    Background="Transparent"
                                    ItemsSource="{Binding TagStamps}">
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <StackPanel />
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>

                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <StackPanel>
                                                <chao:PathCheckButton
                                                    Height="30"
                                                    Margin="0"
                                                    CheckedBrush="{DynamicResource Window.Side.Hover.Background}"
                                                    CornerRadius="0"
                                                    Fill="{Binding BackgroundBrush}"
                                                    FontSize="12"
                                                    Foreground="{DynamicResource Global.Foreground}"
                                                    IsChecked="{Binding Selected, Mode=TwoWay}"
                                                    MainText="{Binding TagName}"
                                                    Path="M121.6 247.872h780.8c23.488 0 42.496 19.008 42.496 42.496v417.92a42.496 42.496 0 0 1-42.496 42.496H121.6a42.496 42.496 0 0 1-42.496-42.496v-417.92a42.496 42.496 0 0 1 42.496-42.496z"
                                                    PathHeight="20"
                                                    PathMargin="5 -5 5 0"
                                                    SubText="{Binding Count}"
                                                    Tag="{Binding TagID}">
                                                    <chao:PathCheckButton.ContextMenu>
                                                        <ContextMenu>
                                                            <MenuItem Header="{x:Static lang:Resources.Edit}" />
                                                            <MenuItem Header="{x:Static lang:Resources.Delete}" />
                                                        </ContextMenu>
                                                    </chao:PathCheckButton.ContextMenu>
                                                </chao:PathCheckButton>
                                            </StackPanel>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>

                        </chao:TogglePanel>
                    </Grid>

                    <!--  快速访问  -->
                    <Grid x:Name="ListGrid" Grid.Row="4">
                        <Border
                            Margin="5"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Top"
                            Panel.ZIndex="6"
                            Style="{StaticResource RoundBorder}"
                            Tag="{DynamicResource Window.Title.Hover.Background}"
                            ToolTip="{x:Static lang:Resources.Add}">
                            <Viewbox Width="auto" Height="14">
                                <Path
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Data="M867.7 423.8H599.8V155.9c0-49.3-40-89.3-89.3-89.3s-89.3 40-89.3 89.3v267.9H153.3c-49.3 0-89.3 40-89.3 89.3s40 89.3 89.3 89.3h267.9v267.9c0 49.3 40 89.3 89.3 89.3s89.3-40 89.3-89.3V602.4h267.9c49.3 0 89.3-40 89.3-89.3s-40-89.3-89.3-89.3z"
                                    Fill="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}" />
                            </Viewbox>
                        </Border>

                        <chao:TogglePanel
                            Padding="0,5"
                            FontSize="15"
                            Header="快速访问"
                            IsEnabled="False"
                            IsExpanded="True"
                            IsSelected="False"
                            LineWidth="0"
                            Style="{StaticResource BaseTogglePanel}">
                            <StackPanel>

                                <ItemsControl
                                    x:Name="MyListItemsControl"
                                    Background="Transparent"
                                    ItemsSource="{Binding MyList}">
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <StackPanel />
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>

                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <chao:PathRadioButton
                                                MainText="{Binding Name}"
                                                Path="M506.88 88.669091c-231.330909 0-418.909091 187.578182-418.909091 418.909091s187.578182 418.909091 418.909091 418.909091 418.909091-187.578182 418.909091-418.909091-187.578182-418.909091-418.909091-418.909091z m178.036364 661.178182c-8.843636 8.378182-20.247273 12.567273-31.650909 12.567272-12.567273 0-24.901818-4.887273-33.978182-14.894545l-177.338182-190.836364V299.52c0-25.6 20.945455-46.545455 46.545454-46.545455s46.545455 20.945455 46.545455 46.545455v220.625455l152.436364 163.84c17.221818 18.850909 16.290909 48.407273-2.56 65.861818z"
                                                Style="{StaticResource BasePathRadioButton}"
                                                SubText="{Binding Number}" />
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>

                        </chao:TogglePanel>

                    </Grid>

                    <Grid
                        Grid.Row="5"
                        Margin="0,0,5,5"
                        VerticalAlignment="Bottom"
                        Cursor="Hand">
                        <Image
                            Height="20"
                            Margin="20,0"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            Source="/Resources/Picture/Title.png"
                            ToolTip="Jvedio" />




                    </Grid>

                </Grid>
            </Border>

            <!--  左右调节  -->
            <GridSplitter
                Grid.Column="0"
                Width="5"
                Panel.ZIndex="10"
                Style="{StaticResource HoverSpliter}" />
            <Grid Grid.Column="1">
                <Grid.RowDefinitions>
                    <RowDefinition Height="auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>
                <Grid Grid.Row="0">
                    <!--  搜索  -->
                    <chao:SearchBox
                        Name="searchBox"
                        Width="auto"
                        Height="30"
                        Margin="0"
                        Padding="0"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Top"
                        Background="{DynamicResource Window.Detail.Background}"
                        BorderBrush="#326CF3"
                        BorderThickness="0"
                        Foreground="{DynamicResource Global.Foreground}"
                        PlaceHolder="搜索"
                        PlaceHolderForeground="{DynamicResource TextBox.PlaceHolder.Foreground}"
                        SearchOnTextChanged="False"
                        ShowClearButton="True"
                        ShowSearchButton="True"
                        Text="{Binding SearchText, Mode=TwoWay}"
                        TextPadding="5 0"
                        Visibility="Hidden" />

                    <Popup
                        x:Name="searchResultPopup"
                        Width="{Binding ElementName=searchBox, Path=ActualWidth}"
                        MinHeight="300"
                        AllowsTransparency="True"
                        HorizontalOffset="-5"
                        IsOpen="{Binding Searching}"
                        Placement="Bottom"
                        PlacementTarget="{Binding ElementName=searchBox}"
                        PopupAnimation="Fade"
                        StaysOpen="False"
                        VerticalOffset="-5">
                        <Grid Margin="5">
                            <Border
                                Margin="5"
                                Background="{DynamicResource Menu.Background}"
                                CornerRadius="0 0 5 5"
                                Effect="{StaticResource PopupDropShadowEffect}" />
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*" />
                                    <RowDefinition Height="auto" />
                                </Grid.RowDefinitions>

                                <TabControl
                                    Name="searchTabControl"
                                    Grid.Row="0"
                                    Margin="10,10,10,0"
                                    Background="Transparent"
                                    FocusVisualStyle="{x:Null}"
                                    ItemContainerStyle="{StaticResource FlatTabItem}"
                                    SelectedIndex="{Binding SearchSelectedIndex, Mode=TwoWay}"
                                    Style="{StaticResource FlatTabControl}">
                                    <TabItem Header="识别码" />
                                    <TabItem Header="名称" />
                                    <TabItem Header="演员" />
                                    <TabItem Header="标签" />
                                    <TabItem Header="类别" />
                                    <TabItem Header="系列" />
                                    <TabItem Header="发行商" />
                                    <TabItem Header="导演" />
                                </TabControl>
                                <Grid
                                    Grid.Row="1"
                                    Margin="5"
                                    Background="{DynamicResource Menu.Background}"
                                    Visibility="Collapsed">
                                    <Button HorizontalAlignment="Left" Content="清除记录" />
                                </Grid>
                            </Grid>
                        </Grid>
                    </Popup>


                </Grid>
                <TabControl
                    Grid.Row="1"
                    Background="Transparent"
                    FocusVisualStyle="{x:Null}"
                    ItemContainerStyle="{StaticResource FlatTabItem}"
                    SelectedIndex="{Binding TabSelectedIndex, FallbackValue=0}"
                    Style="{StaticResource FlatTabControl}">
                    <TabItem Header="资源">
                        <!--  资源  -->
                        <Grid HorizontalAlignment="Stretch">

                            <Grid.RowDefinitions>
                                <RowDefinition Height="auto" />
                                <RowDefinition Height="*" />
                                <RowDefinition Height="auto" />
                            </Grid.RowDefinitions>


                            <!--  工具栏  -->
                            <Grid
                                Grid.Row="0"
                                Panel.ZIndex="4"
                                Background="Transparent"
                                Visibility="{Binding DisplayFunBar, Converter={StaticResource BoolToVis}, Mode=TwoWay, Source={x:Static p:Settings.Default}}">

                                <Grid.RowDefinitions>
                                    <RowDefinition Height="auto" />
                                    <RowDefinition Height="auto" />
                                </Grid.RowDefinitions>




                                <Grid Grid.Row="0">



                                    <StackPanel Orientation="Horizontal">





                                        <!--<Grid
                                                Width="300"
                                                Height="40"
                                                Margin="10,5"
                                                HorizontalAlignment="Left"
                                                Focusable="True">
                                                <Border
                                                    Background="Transparent"
                                                    BorderBrush="{DynamicResource Window.Side.Background}"
                                                    BorderThickness="2"
                                                    CornerRadius="2" />


                                                <Grid
                                                    Width="25"
                                                    Margin="10,0,0,0"
                                                    HorizontalAlignment="Left"
                                                    VerticalAlignment="Center"
                                                    Panel.ZIndex="3"
                                                    Cursor="Hand"
                                                    MouseUp="ShowSearchMenu">
                                                    <Image
                                                        Width="20"
                                                        Height="20"
                                                        RenderTransformOrigin=".5,.5"
                                                        Source="{Binding Themes, Mode=OneWay, ConverterParameter=up, Converter={StaticResource StringToUriStringConverter}, Source={x:Static p:Settings.Default}}">
                                                        <Image.RenderTransform>
                                                            <RotateTransform Angle="180" />
                                                        </Image.RenderTransform>
                                                    </Image>
                                                    <Popup
                                                        x:Name="SearchOptionPopup"
                                                        AllowsTransparency="True"
                                                        HorizontalOffset="-15"
                                                        IsOpen="False"
                                                        Placement="Bottom"
                                                        PopupAnimation="Fade"
                                                        StaysOpen="False"
                                                        VerticalOffset="5">
                                                        <Grid Margin="5">
                                                            <Border
                                                                Margin="5"
                                                                Background="{DynamicResource Popup.Background}"
                                                                CornerRadius="5"
                                                                Effect="{StaticResource PopupDropShadowEffect}" />
                                                            <StackPanel Margin="5">
                                                                <RadioButton
                                                                    Click="SaveAllSearchType"
                                                                    Content="{x:Static lang:Resources.ID}"
                                                                    FocusVisualStyle="{x:Null}"
                                                                    GroupName="SearchTypeRadioButton"
                                                                    IsChecked="True"
                                                                    Style="{StaticResource RadioButtonStyle}"
                                                                    Template="{DynamicResource RadioButtonControlTemplate1}" />
                                                                <RadioButton
                                                                    Click="SaveAllSearchType"
                                                                    Content="{x:Static lang:Resources.Title}"
                                                                    FocusVisualStyle="{x:Null}"
                                                                    GroupName="SearchTypeRadioButton"
                                                                    Style="{StaticResource RadioButtonStyle}"
                                                                    Template="{DynamicResource RadioButtonControlTemplate1}" />
                                                                <RadioButton
                                                                    Click="SaveAllSearchType"
                                                                    Content="{x:Static lang:Resources.Actor}"
                                                                    FocusVisualStyle="{x:Null}"
                                                                    GroupName="SearchTypeRadioButton"
                                                                    Style="{StaticResource RadioButtonStyle}"
                                                                    Template="{DynamicResource RadioButtonControlTemplate1}" />
                                                                <CheckBox
                                                                    Margin="5,0"
                                                                    Content="{x:Static lang:Resources.SearchCurrent}"
                                                                    IsChecked="{Binding SearchInCurrent, Mode=TwoWay}"
                                                                    Style="{StaticResource CheckBoxStyle1}" />
                                                            </StackPanel>
                                                        </Grid>
                                                    </Popup>
                                                </Grid>

                                                <hc:SearchBar
                                                    x:Name="SearchBar"
                                                    Margin="5,5,5,5"
                                                    Padding="35,0"
                                                    hc:InfoElement.Placeholder="{Binding SearchHint}"
                                                    hc:InfoElement.Title=""
                                                    hc:InfoElement.TitleWidth="140"
                                                    Background="Transparent"
                                                    BorderThickness="0"
                                                    CaretBrush="{DynamicResource Window.Foreground}"
                                                    ContextMenu="{StaticResource TextBoxContextMenu}"
                                                    Focusable="True"
                                                    Foreground="{DynamicResource Global.Foreground}"
                                                    GotFocus="SearchBar_GotFocus"
                                                    LostFocus="SearchBar_LostFocus"
                                                    PreviewKeyUp="SearchBar_PreviewKeyUp"
                                                    PreviewMouseLeftButtonDown="ShowSearchPopup"
                                                    SearchStarted="SearchBar_SearchStarted"
                                                    ShowClearButton="True"
                                                    Style="{StaticResource SearchBarPlus}"
                                                    TextChanged="RefreshCandiadte" />

                                                <Popup
                                                    Width="{Binding RelativeSource={RelativeSource AncestorType={x:Type Grid}, Mode=FindAncestor}, Path=ActualWidth}"
                                                    AllowsTransparency="True"
                                                    Focusable="True"
                                                    HorizontalOffset="0"
                                                    IsOpen="{Binding ShowSearchPopup, FallbackValue=False}"
                                                    Placement="Bottom"
                                                    StaysOpen="True"
                                                    VerticalOffset="2"
                                                    Visibility="Visible">
                                                    <Grid Margin="5">
                                                        <Border
                                                            Name="SearchBorder"
                                                            Margin="5"
                                                            Background="{DynamicResource Popup.Background}"
                                                            CornerRadius="5"
                                                            Effect="{StaticResource PopupDropShadowEffect}" />

                                                        <ScrollViewer
                                                            Canvas.Top="40"
                                                            Width="auto"
                                                            Height="auto"
                                                            Margin="10"
                                                            Panel.ZIndex="4"
                                                            Background="Transparent"
                                                            HorizontalScrollBarVisibility="Hidden"
                                                            VerticalScrollBarVisibility="Hidden">
                                                            <StackPanel>
                                                                <StackPanel x:Name="SearchHistoryStackPanel">

                                                                    <StackPanel Orientation="Horizontal">
                                                                        <TextBlock
                                                                            Height="auto"
                                                                            Margin="5"
                                                                            HorizontalAlignment="Left"
                                                                            VerticalAlignment="Center"
                                                                            FontSize="12"
                                                                            Style="{StaticResource BaseTextBlock}"
                                                                            Text="{x:Static lang:Resources.SearchHistory}" />
                                                                        <Border
                                                                            Width="20"
                                                                            Height="20"
                                                                            Margin="5,0"
                                                                            CornerRadius="3"
                                                                            MouseLeftButtonDown="ClearSearchHistory"
                                                                            Style="{StaticResource CloseBorderStyle}">
                                                                            <Image
                                                                                Width="15"
                                                                                Height="15"
                                                                                Source="{Binding Themes, Mode=OneWay, ConverterParameter=clear, Converter={StaticResource StringToUriStringConverter}, Source={x:Static p:Settings.Default}}" />
                                                                        </Border>
                                                                    </StackPanel>

                                                                    <ItemsControl
                                                                        Width="{Binding ElementName=SearchBorder, Path=ActualWidth, Converter={StaticResource WidthConverter}, ConverterParameter=-20, Mode=OneWay}"
                                                                        Margin="5,0"
                                                                        HorizontalAlignment="Left"
                                                                        Background="Transparent"
                                                                        ItemsSource="{Binding SearchHistory, Mode=OneWay}"
                                                                        ScrollViewer.VerticalScrollBarVisibility="Disabled">
                                                                        <ItemsControl.ItemsPanel>
                                                                            <ItemsPanelTemplate>
                                                                                <WrapPanel Orientation="Horizontal" />
                                                                            </ItemsPanelTemplate>
                                                                        </ItemsControl.ItemsPanel>

                                                                        <ItemsControl.ItemTemplate>
                                                                            <DataTemplate>

                                                                                <Border CornerRadius="3" Style="{StaticResource BorderStyle}">
                                                                                    <TextBlock
                                                                                        Width="auto"
                                                                                        Margin="10,5"
                                                                                        Padding="2"
                                                                                        FontSize="15"
                                                                                        PreviewMouseLeftButtonDown="SetSearchValue"
                                                                                        Style="{StaticResource SearchCandidateTextBlock}"
                                                                                        Text="{Binding}"
                                                                                        TextWrapping="NoWrap"
                                                                                        ToolTip="{Binding Path=Text, RelativeSource={RelativeSource Mode=Self}}" />
                                                                                </Border>

                                                                            </DataTemplate>
                                                                        </ItemsControl.ItemTemplate>
                                                                    </ItemsControl>
                                                                </StackPanel>

                                                                <TextBlock
                                                                    Grid.Row="0"
                                                                    Margin="5"
                                                                    HorizontalAlignment="Left"
                                                                    FontSize="12"
                                                                    Style="{StaticResource BaseTextBlock}"
                                                                    Text="{x:Static lang:Resources.SearchResult}" />

                                                                <ItemsControl
                                                                    x:Name="SearchItemsControl"
                                                                    Background="Transparent"
                                                                    ItemsSource="{Binding CurrentSearchCandidate}"
                                                                    ScrollViewer.VerticalScrollBarVisibility="Disabled">
                                                                    <ItemsControl.ItemsPanel>
                                                                        <ItemsPanelTemplate>
                                                                            <StackPanel Orientation="Vertical" />
                                                                        </ItemsPanelTemplate>
                                                                    </ItemsControl.ItemsPanel>

                                                                    <ItemsControl.ItemTemplate>
                                                                        <DataTemplate>
                                                                            <StackPanel Name="SearchStackPanel">

                                                                                <Border CornerRadius="3" Style="{StaticResource BorderStyle}">
                                                                                    <TextBlock
                                                                                        Width="auto"
                                                                                        Margin="10,5"
                                                                                        Padding="2"
                                                                                        FontSize="15"
                                                                                        PreviewMouseLeftButtonDown="SetSearchValue"
                                                                                        Style="{StaticResource SearchCandidateTextBlock}"
                                                                                        Text="{Binding}"
                                                                                        TextWrapping="NoWrap"
                                                                                        ToolTip="{Binding Path=Text, RelativeSource={RelativeSource Mode=Self}}" />

                                                                                </Border>

                                                                            </StackPanel>
                                                                        </DataTemplate>
                                                                    </ItemsControl.ItemTemplate>
                                                                </ItemsControl>

                                                            </StackPanel>
                                                        </ScrollViewer>
                                                    </Grid>
                                                </Popup>
                                            </Grid>-->

                                    </StackPanel>



                                    <StackPanel HorizontalAlignment="Stretch" Orientation="Horizontal">


                                        <chao:Switch
                                            Height="25"
                                            Background="{DynamicResource Window.Side.Background}"
                                            CheckedBackground="{DynamicResource CheckBox.Checked.Background}"
                                            Click="SetSelectMode"
                                            IsChecked="{Binding EditMode, Mode=TwoWay}" />
                                        <TextBlock
                                            VerticalAlignment="Center"
                                            Style="{StaticResource BaseTextBlock}"
                                            Text="{x:Static lang:Resources.MultiSelect}" />







                                        <Border
                                            VerticalAlignment="Center"
                                            Background="{DynamicResource Window.Side.Background}"
                                            CornerRadius="5">
                                            <StackPanel Name="ViewModeStackPanel" Orientation="Horizontal">

                                                <chao:PathRadioButton
                                                    Padding="0,0,0,0"
                                                    CornerRadius="5,0,0,5"
                                                    Path="M934.4 107.52H89.6c-20.48 0-35.84 15.36-35.84 35.84V883.2c0 20.48 15.36 35.84 35.84 35.84h844.8c20.48 0 35.84-15.36 35.84-35.84V143.36c0-20.48-15.36-35.84-35.84-35.84z m-35.84 739.84H125.44V176.64h775.68v670.72h-2.56z m0 0 M335.36 440.32c38.4 0 71.68-30.72 71.68-71.68 0-38.4-30.72-71.68-71.68-71.68-38.4 0-71.68 30.72-71.68 71.68 2.56 40.96 33.28 71.68 71.68 71.68z m0 0M652.8 396.8L445.44 691.2 337.92 540.16 158.72 793.6h704L652.8 396.8z m0 0"
                                                    PathHeight="18"
                                                    Style="{StaticResource PathGroupRadioButton}"
                                                    ToolTip="{x:Static lang:Resources.Poster}" />
                                                <chao:PathRadioButton
                                                    CornerRadius="0"
                                                    Path="M1024 170.666667v682.666666H0V170.666667h1024zM85.333333 256v512h853.333334V256H85.333333z m354.133334 280.106667c0 82.730667-51.477333 133.333333-136.469334 133.333333-92.501333 0-148.117333-59.776-148.117333-158.72 0-97.706667 55.829333-158.144 146.026667-158.144 73.344 0 127.936 42.709333 135.424 106.24h-75.413334c-7.509333-26.453333-29.994667-42.474667-60.010666-42.474667-42.688 0-68.117333 34.986667-68.117334 93.525334 0 59.584 28.117333 95.850667 71.893334 95.850666 34.773333 0 58.944-20.416 60.8-50.837333l0.213333-5.013333h-54.997333v-52.48H439.466667v38.741333zM573.013333 661.333333h-76.48V360.704h76.458667V661.333333z m147.285334 0H643.84V360.704h204.586667v61.461333h-128.128v68.544h116.245333v58.538667h-116.266667V661.333333z"
                                                    PathHeight="17"
                                                    Style="{StaticResource PathGroupRadioButton}"
                                                    ToolTip="GIF"
                                                    Visibility="Collapsed" />
                                                <chao:PathRadioButton
                                                    CornerRadius="0,5,5,0"
                                                    Path="M64 480h352V128H64v352z m64-288h224v224H128V192zM64 928h352V576H64v352z m64-288h224v224H128v-224zM526.848 224H928a32 32 0 1 0 0-64H526.848a32 32 0 0 0 0 64zM928 608H526.848a32 32 0 1 0 0 64H928a32 32 0 1 0 0-64zM928 384H526.848a32 32 0 0 0 0 64H928a32 32 0 1 0 0-64zM928 832H526.848a32 32 0 1 0 0 64H928a32 32 0 1 0 0-64z"
                                                    PathHeight="17"
                                                    Style="{StaticResource PathGroupRadioButton}" />
                                            </StackPanel>
                                        </Border>

                                        <Border
                                            Name="SortBorder"
                                            MouseUp="ShowContextMenu"
                                            Style="{StaticResource ToolsBarBorderStyle}"
                                            ToolTip="{x:Static lang:Resources.Sorting}">
                                            <Border.ContextMenu>
                                                <ContextMenu HorizontalOffset="-50">

                                                    <MenuItem Header="{x:Static lang:Resources.FileSize}" IsCheckable="True" />
                                                    <MenuItem Header="{x:Static lang:Resources.CreatedDate}" IsCheckable="True" />
                                                    <MenuItem Header="{x:Static lang:Resources.ImportDate}" IsCheckable="True" />
                                                    <MenuItem Header="{x:Static lang:Resources.Favorites}" IsCheckable="True" />
                                                    <MenuItem Header="{x:Static lang:Resources.Title}" IsCheckable="True" />
                                                    <MenuItem Header="{x:Static lang:Resources.ViewNumber}" IsCheckable="True" />
                                                    <MenuItem Header="{x:Static lang:Resources.ReleaseDate}" IsCheckable="True" />
                                                    <MenuItem Header="{x:Static lang:Resources.Rating}" IsCheckable="True" />

                                                </ContextMenu>
                                            </Border.ContextMenu>
                                            <Viewbox Width="auto" Height="18">
                                                <Path
                                                    HorizontalAlignment="Center"
                                                    VerticalAlignment="Center"
                                                    Data="M44.032 451.584c-22.528 0-40.96 18.432-40.96 40.96v38.912c0 22.528 18.432 40.96 40.96 40.96h519.68c22.528 0 40.96-18.432 40.96-40.96v-38.912c0-22.528-18.432-40.96-40.96-40.96H44.032z m0 302.592c-22.528 0-40.96 18.432-40.96 40.96v38.912c0 22.528 18.432 40.96 40.96 40.96h519.68c22.528 0 40.96-18.432 40.96-40.96v-38.912c0-22.528-18.432-40.96-40.96-40.96H44.032z m519.68-484.352c22.528 0 40.96-18.432 40.96-40.96v-38.912c0-22.528-18.432-40.96-40.96-40.96H44.032c-22.528 0-40.96 18.432-40.96 40.96v38.912c0 22.528 18.432 40.96 40.96 40.96h519.68z m170.496-120.832c-22.528 0-40.96 18.432-40.96 40.96V834.56c0 22.528 18.432 40.96 40.96 40.96h38.912c15.36 0 28.16-8.192 35.328-20.48l212.48-212.48c0-22.528-18.432-40.96-40.96-40.96H814.08V189.952c0-22.528-18.432-40.96-40.96-40.96h-38.912z"
                                                    Fill="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}" />
                                            </Viewbox>
                                        </Border>



                                    </StackPanel>



                                </Grid>





                            </Grid>




                            <!--  信息展示：演员信息+影片展示  -->
                            <Grid Grid.Row="1">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>




                                <!--  影片  -->
                                <Grid
                                    Grid.Column="1"
                                    Panel.ZIndex="2"
                                    AllowDrop="True"
                                    DragOver="Grid_DragOver"
                                    Drop="Grid_Drop"
                                    FocusVisualStyle="{x:Null}">
                                    <Grid.ContextMenu>
                                        <ContextMenu>
                                            <MenuItem Header="{x:Static lang:Resources.Refresh}" IsEnabled="False" />
                                            <MenuItem Header="选中/取消当前页" />
                                            <MenuItem
                                                Command="{Binding FlipOverCommand}"
                                                Header="{x:Static lang:Resources.ShowExists}"
                                                IsCheckable="True"
                                                IsChecked="{Binding OnlyShowPlay, Mode=TwoWay, Source={x:Static p:Settings.Default}}"
                                                IsEnabled="False" />
                                            <MenuItem
                                                Command="{Binding FlipOverCommand}"
                                                Header="{x:Static lang:Resources.ShowSubSection}"
                                                IsCheckable="True"
                                                IsChecked="{Binding OnlyShowSubSection, Mode=TwoWay, Source={x:Static p:Settings.Default}}"
                                                IsEnabled="False" />

                                        </ContextMenu>
                                    </Grid.ContextMenu>


                                    <ScrollViewer
                                        x:Name="MovieScrollViewer"
                                        CanContentScroll="True"
                                        FocusVisualStyle="{x:Null}"
                                        IsDeferredScrollingEnabled="False"
                                        Style="{StaticResource FlatScrollViewer}"
                                        VerticalScrollBarVisibility="Auto">
                                        <!--  影片  -->
                                        <ItemsControl
                                            x:Name="MovieItemsControl"
                                            Background="{DynamicResource Window.Background}"
                                            FocusVisualStyle="{x:Null}"
                                            ItemsSource="{Binding CurrentDataList}">
                                            <ItemsControl.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <WrapPanel />
                                                </ItemsPanelTemplate>
                                            </ItemsControl.ItemsPanel>

                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <!--  影片加载动画  -->
                                                    <DataTemplate.Triggers>
                                                        <EventTrigger RoutedEvent="FrameworkElement.Loaded">
                                                            <BeginStoryboard>
                                                                <Storyboard>
                                                                    <DoubleAnimation
                                                                        FillBehavior="Stop"
                                                                        Storyboard.TargetName="rootGrid"
                                                                        Storyboard.TargetProperty="(UIElement.Opacity)"
                                                                        From="0"
                                                                        To="1"
                                                                        Duration="0:0:0.3" />
                                                                </Storyboard>
                                                            </BeginStoryboard>
                                                        </EventTrigger>
                                                    </DataTemplate.Triggers>

                                                    <Grid
                                                        Name="rootGrid"
                                                        Width="{Binding GlobalImageWidth, Source={x:Static p:Settings.Default}, Mode=OneWay}"
                                                        Margin="10"
                                                        Tag="{Binding DataID, Mode=OneWay}">
                                                        <Border
                                                            Name="rootBorder"
                                                            MinWidth="200"
                                                            Margin="0"
                                                            Background="{DynamicResource ListBoxItem.Background}"
                                                            BorderThickness="2"
                                                            CornerRadius="3"
                                                            Effect="{StaticResource BlueDropShadowEffect}"
                                                            Opacity="{Binding MovieOpacity, Mode=OneWay, Source={x:Static p:Settings.Default}}"
                                                            Style="{StaticResource SimpleBorder}" />
                                                        <Grid Margin="0" Tag="{Binding id, Mode=OneWay}">

                                                            <Grid.RowDefinitions>
                                                                <RowDefinition Height="auto" />
                                                                <RowDefinition Height="auto" />
                                                                <RowDefinition Height="auto" />
                                                                <RowDefinition Height="auto" />
                                                                <RowDefinition Height="auto" />
                                                            </Grid.RowDefinitions>
                                                            <!--  图片  -->
                                                            <Grid
                                                                Grid.Row="0"
                                                                MouseEnter="Grid_MouseEnter"
                                                                MouseLeave="Grid_MouseLeave">

                                                                <!--  GIF图  -->


                                                                <local:GifImage
                                                                    x:Name="GifImage"
                                                                    Margin="2"
                                                                    HorizontalAlignment="Center"
                                                                    VerticalAlignment="Center"
                                                                    BigImageSource="{Binding ViewImage, Mode=OneWay}"
                                                                    Cursor="Hand"
                                                                    MouseEnter="DataMouseEnter"
                                                                    MouseLeave="DataMouseLeave"
                                                                    MouseLeftButtonDown="CanShowDetails"
                                                                    MouseLeftButtonUp="ShowDetails"
                                                                    Stretch="{Binding Path=MainImageAutoMode, Source={x:Static p:Settings.Default}, Converter={StaticResource BoolToImageStretchConverter}, Mode=OneWay}"
                                                                    Style="{StaticResource GifImageStyle}">
                                                                    <Image.ContextMenu>
                                                                        <ContextMenu
                                                                            ContextMenuOpening="ContextMenu_ContextMenuOpening"
                                                                            Opacity="0.9"
                                                                            PreviewKeyUp="ContextMenu_PreviewKeyUp">


                                                                            <MenuItem Click="EditInfo" Header="{x:Static lang:Resources.Menu_EditInfo}" />




                                                                            <MenuItem Header="{x:Static lang:Resources.OpenPath}" Visibility="{Binding EditMode, Source={x:Static p:Settings.Default}, Converter={StaticResource BoolToOppositeVisibilityConverter}}">
                                                                                <MenuItem
                                                                                    Command="cmd:File.OpenSelectFile"
                                                                                    CommandParameter="{Binding Path}"
                                                                                    Header="资源" />

                                                                            </MenuItem>
                                                                            <MenuItem
                                                                                Name="TagMenuItems"
                                                                                Header="添加标记"
                                                                                IsEnabled="False" />
                                                                            <MenuItem
                                                                                Click="OpenWeb"
                                                                                Header="访问所在网址"
                                                                                Icon="pack://application:,,,/Resources/menuitem/openwebsite.png"
                                                                                IsEnabled="False" />
                                                                            <MenuItem Click="CopyFile" Header="{x:Static lang:Resources.Menu_CopyFile}" />
                                                                            <MenuItem
                                                                                Click="DeleteID"
                                                                                Header="{x:Static lang:Resources.Menu_DeleteInfo}"
                                                                                ToolTip="{x:Static lang:Resources.ToolTip_DeleteInfo}" />
                                                                            <MenuItem
                                                                                Click="DeleteFile"
                                                                                Header="{x:Static lang:Resources.Menu_DeleteFile}"
                                                                                Icon="pack://application:,,,/Resources/menuitem/clear.png"
                                                                                ToolTip="{x:Static lang:Resources.ToolTip_DeleteFile}" />



                                                                        </ContextMenu>
                                                                    </Image.ContextMenu>
                                                                </local:GifImage>
                                                                <!--  是否含有视频  -->
                                                                <Button
                                                                    Height="auto"
                                                                    Margin="5"
                                                                    Padding="5"
                                                                    HorizontalAlignment="Right"
                                                                    VerticalAlignment="Bottom"
                                                                    Panel.ZIndex="3"
                                                                    Click="ShowVideo"
                                                                    Cursor="Hand"
                                                                    IsEnabled="{Binding EditMode, Mode=TwoWay, Source={x:Static p:Settings.Default}, Converter={StaticResource OppositeBooleanConverter}}"
                                                                    Style="{StaticResource RoundNormalButton}"
                                                                    Tag="{DynamicResource Button.Hover.Background}"
                                                                    Visibility="{Binding HasVideo, Converter={StaticResource BoolToVisibilityConverter}, Mode=OneWay}">
                                                                    <Button.ContextMenu>
                                                                        <ContextMenu HorizontalOffset="-50" VerticalOffset="10" />
                                                                    </Button.ContextMenu>
                                                                    <Image
                                                                        Width="20"
                                                                        Height="20"
                                                                        Source="/Resources/Picture/subsection1.png" />
                                                                </Button>

                                                                <Border
                                                                    Margin="10"
                                                                    Padding="5"
                                                                    HorizontalAlignment="Left"
                                                                    VerticalAlignment="Bottom"
                                                                    Background="{DynamicResource Global.Background}"
                                                                    CornerRadius="5"
                                                                    Opacity="0.7">
                                                                    <Border.Style>
                                                                        <Style TargetType="Border">
                                                                            <Style.Triggers>
                                                                                <DataTrigger Binding="{Binding Count}" Value="0">
                                                                                    <Setter Property="Visibility" Value="Collapsed" />
                                                                                </DataTrigger>
                                                                            </Style.Triggers>
                                                                        </Style>
                                                                    </Border.Style>
                                                                    <TextBlock Text="{Binding Count, FallbackValue=0}" />
                                                                </Border>


                                                                <Border
                                                                    Name="runBorder"
                                                                    HorizontalAlignment="Center"
                                                                    MouseUp="ShowRunMenu"
                                                                    Opacity="0.9"
                                                                    Style="{StaticResource ToolsBarBorderStyle}"
                                                                    ToolTip="{x:Static lang:Resources.Run}"
                                                                    Visibility="Hidden">

                                                                    <Border.ContextMenu>
                                                                        <ContextMenu HorizontalOffset="-50">

                                                                            <MenuItem Header="运行" />
                                                                            <MenuItem Header="以管理员身份运行" />
                                                                            <MenuItem Header="Locale Emulator" />


                                                                        </ContextMenu>
                                                                    </Border.ContextMenu>
                                                                    <Viewbox Width="auto" Height="30">
                                                                        <Path
                                                                            HorizontalAlignment="Center"
                                                                            VerticalAlignment="Center"
                                                                            Data="M512 0C229.376 0 0 229.376 0 512s229.376 512 512 512 512-229.376 512-512S794.624 0 512 0zM460.8 254.976c0-28.16 23.04-51.2 51.2-51.2s51.2 23.04 51.2 51.2v256c0 28.16-23.04 51.2-51.2 51.2s-51.2-23.04-51.2-51.2v-256z m51.2 565.248c-169.472 0-307.2-137.728-307.2-307.2 0-92.672 40.96-179.2 113.152-238.08 22.016-17.92 54.272-14.848 72.192 7.168s14.848 54.272-7.168 72.192c-48.128 38.912-75.264 96.768-75.264 158.72 0 113.152 91.648 204.8 204.8 204.8s204.8-91.648 204.8-204.8c0-61.952-27.648-119.808-75.264-158.72-22.016-17.92-25.088-50.176-7.168-72.192 17.92-22.016 50.176-25.088 72.192-7.168 71.68 58.88 113.152 145.408 113.152 238.08-1.024 169.472-138.752 307.2-308.224 307.2z"
                                                                            Fill="{DynamicResource Common.HighLight.Deep.Background}" />
                                                                    </Viewbox>
                                                                </Border>




                                                            </Grid>


                                                            <!--  标签戳  -->
                                                            <Grid
                                                                Grid.Row="1"
                                                                Width="auto"
                                                                HorizontalAlignment="Stretch"
                                                                IsEnabled="{Binding EditMode, Mode=TwoWay, Source={x:Static p:Settings.Default}, Converter={StaticResource OppositeBooleanConverter}}">


                                                                <TextBox
                                                                    Grid.Row="4"
                                                                    Width="{Binding Path=GlobalImageWidth, Source={x:Static p:Settings.Default}, Converter={StaticResource BiggerWidthConverter}, Mode=OneWay}"
                                                                    Height="35"
                                                                    Margin="0,5,0,15"
                                                                    Padding="10,0"
                                                                    HorizontalAlignment="Center"
                                                                    Background="Transparent"
                                                                    FontSize="14"
                                                                    Foreground="{DynamicResource Global.Foreground}"
                                                                    IsEnabled="{Binding EditMode, Mode=TwoWay, Source={x:Static p:Settings.Default}, Converter={StaticResource OppositeBooleanConverter}}"
                                                                    Opacity="0.5"
                                                                    Style="{StaticResource ReadOnlyNoWrapTextBox}"
                                                                    Text="{Binding Title, Mode=OneWay}"
                                                                    TextAlignment="Left"
                                                                    TextWrapping="Wrap"
                                                                    ToolTip="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Text}"
                                                                    Visibility="{Binding Path=DisplayTitle, Converter={StaticResource BoolToVis}, Source={x:Static p:Settings.Default}, Mode=OneWay}" />

                                                                <!--  标签戳  -->

                                                                <ItemsControl
                                                                    Grid.Column="1"
                                                                    Margin="5,5"
                                                                    HorizontalAlignment="Right"
                                                                    ItemsSource="{Binding TagStamp}"
                                                                    Visibility="{Binding Path=DisplayStamp, Converter={StaticResource BoolToVis}, Source={x:Static p:Settings.Default}, Mode=OneWay}">
                                                                    <ItemsControl.ItemsPanel>
                                                                        <ItemsPanelTemplate>
                                                                            <StackPanel Orientation="Horizontal" />
                                                                        </ItemsPanelTemplate>
                                                                    </ItemsControl.ItemsPanel>
                                                                    <ItemsControl.ItemTemplate>
                                                                        <DataTemplate>
                                                                            <Label
                                                                                Margin="2,0"
                                                                                Padding="4"
                                                                                Background="{Binding BackgroundBrush}"
                                                                                BorderThickness="0"
                                                                                Content="{Binding TagName}"
                                                                                Foreground="{Binding ForegroundBrush}" />

                                                                        </DataTemplate>
                                                                    </ItemsControl.ItemTemplate>
                                                                </ItemsControl>


                                                            </Grid>


                                                            <!--  评分  -->
                                                            <StackPanel
                                                                Grid.Row="3"
                                                                Width="auto"
                                                                Margin="15,5,0,10"
                                                                HorizontalAlignment="Left"
                                                                Cursor="Hand"
                                                                IsEnabled="{Binding EditMode, Mode=TwoWay, Source={x:Static p:Settings.Default}, Converter={StaticResource OppositeBooleanConverter}}"
                                                                PreviewMouseLeftButtonDown="StackPanel_PreviewMouseLeftButtonDown"
                                                                Tag="{Binding DataID, Mode=OneWay}"
                                                                Visibility="{Binding Path=DisplayFavorites, Converter={StaticResource BoolToVis}, Source={x:Static p:Settings.Default}, Mode=OneWay}">
                                                                <hc:Rate
                                                                    AllowClear="True"
                                                                    AllowHalf="True"
                                                                    Background="{DynamicResource Window.Title.Background}"
                                                                    DefaultValue="0"
                                                                    Foreground="{DynamicResource Common.HighLight.Deep.Background}"
                                                                    ItemHeight="15"
                                                                    ItemMargin="3 0"
                                                                    ValueChanged="Rate_ValueChanged"
                                                                    Value="{Binding Grade, Mode=TwoWay}" />
                                                            </StackPanel>


                                                            <!--  日期  -->
                                                            <TextBox
                                                                Grid.Row="2"
                                                                Margin="0,0"
                                                                Padding="10,5"
                                                                HorizontalAlignment="Left"
                                                                Background="Transparent"
                                                                FontSize="15"
                                                                Foreground="{DynamicResource Global.Foreground}"
                                                                IsEnabled="{Binding EditMode, Mode=TwoWay, Source={x:Static p:Settings.Default}, Converter={StaticResource OppositeBooleanConverter}}"
                                                                Opacity="0.5"
                                                                Style="{StaticResource ReadOnlyNoWrapTextBox}"
                                                                Text="{Binding ReleaseDate, Mode=OneWay}"
                                                                TextAlignment="Left"
                                                                Visibility="{Binding Path=DisplayDate, Converter={StaticResource BoolToVis}, Source={x:Static p:Settings.Default}, Mode=OneWay}" />




                                                        </Grid>
                                                    </Grid>

                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>




                                    </ScrollViewer>





                                    <!--  返回顶部  -->
                                    <Canvas
                                        Width="20"
                                        Height="20"
                                        Margin="0,0,70,40"
                                        HorizontalAlignment="Right"
                                        VerticalAlignment="Bottom"
                                        Panel.ZIndex="5"
                                        Cursor="Hand"
                                        Visibility="{Binding GoToTopCanvas, FallbackValue=Hidden}">
                                        <Ellipse
                                            Width="40"
                                            Height="40"
                                            Margin="0,0,5,5"
                                            HorizontalAlignment="Right"
                                            VerticalAlignment="Bottom"
                                            Style="{StaticResource Ellipse2}" />
                                        <Image
                                            Canvas.Left="8"
                                            Canvas.Top="7"
                                            Height="22"
                                            HorizontalAlignment="Left"
                                            Panel.ZIndex="2"
                                            Source="{Binding Themes, Mode=OneWay, ConverterParameter=up, Converter={StaticResource StringToUriStringConverter}, Source={x:Static p:Settings.Default}}" />
                                    </Canvas>
                                </Grid>
                            </Grid>


                            <!--  底部  -->
                            <Grid
                                Grid.Row="2"
                                Panel.ZIndex="5"
                                Visibility="{Binding DisplayStatusBar, Converter={StaticResource BoolToVis}, Mode=TwoWay, Source={x:Static p:Settings.Default}}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="auto" />
                                    <ColumnDefinition Width="auto" />
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" Orientation="Horizontal">

                                    <Slider
                                        Grid.Column="0"
                                        Width="200"
                                        Margin="20,0,0,0"
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Center"
                                        LargeChange="10"
                                        Maximum="800"
                                        Minimum="200"
                                        SmallChange="5"
                                        ValueChanged="ImageSizeSlider_ValueChanged"
                                        Value="{Binding Path=GlobalImageWidth, Source={x:Static p:Settings.Default}, Mode=TwoWay}" />

                                    <TextBlock
                                        VerticalAlignment="Center"
                                        Style="{StaticResource BaseTextBlock}"
                                        Text="{Binding Path=GlobalImageWidth, Source={x:Static p:Settings.Default}, StringFormat=\{0\} px}"
                                        Visibility="Hidden" />

                                </StackPanel>

                                <TextBlock
                                    Grid.Column="1"
                                    VerticalAlignment="Center"
                                    Style="{StaticResource BaseTextBlock}">
                                    <TextBlock.Text>
                                        <MultiBinding StringFormat="{} {0}/{1}">
                                            <Binding Path="CurrentCount" />
                                            <Binding Path="TotalCount" />
                                        </MultiBinding>
                                    </TextBlock.Text>
                                </TextBlock>


                                <!--  页码  -->
                                <chao:Pagination
                                    Name="pagination"
                                    Grid.Column="2"
                                    CurrentPage="{Binding CurrentPage, Mode=OneWay}"
                                    CurrentPageChange="Pagination_CurrentPageChange"
                                    PageSize="{Binding PageSize, Mode=OneWay}"
                                    ShowCombobox="True"
                                    Style="{StaticResource NormalPagination}"
                                    Total="{Binding TotalCount, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />


                            </Grid>

                        </Grid>

                    </TabItem>


                    <TabItem Header="标签（清单）">
                        <Grid Margin="10" HorizontalAlignment="Stretch">
                            <ItemsControl
                                Name="LabelListItemsControl"
                                Margin="5"
                                Background="Transparent"
                                ItemsSource="{Binding LabelList}"
                                ScrollViewer.VerticalScrollBarVisibility="Auto">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <WrapPanel Orientation="Horizontal" />
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Style="{StaticResource RoundBorderStyle}">
                                            <TextBlock Style="{StaticResource GenreTextBlock}" Text="{Binding}" />
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>


                        </Grid>


                    </TabItem>

                </TabControl>
            </Grid>

        </Grid>

        <Grid
            Grid.Row="1"
            Height="30"
            Background="{DynamicResource Window.Title.Background}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="auto" />
                <ColumnDefinition Width="auto" />
            </Grid.ColumnDefinitions>
            <StackPanel Grid.Column="0" Orientation="Horizontal">
                <TextBox
                    Margin="10,0"
                    Padding="0"
                    VerticalContentAlignment="Center"
                    FontSize="12"
                    Style="{StaticResource ReadOnlyNoWrapTextBox}"
                    Text="就绪" />
            </StackPanel>
            <StackPanel
                Grid.Column="2"
                Margin="5,0"
                Orientation="Horizontal">
                <Grid>
                    <Border
                        Name="msgScan"
                        Width="30"
                        Height="30"
                        Margin="0"
                        MouseLeftButtonUp="ShowMsgScanPopup"
                        Style="{StaticResource FlatBorderStyle}">

                        <Viewbox Height="15" Margin="-5,0,0,0">
                            <Path Data="M232 64c-30.928 0-56 25.072-56 56v784c0 30.928 25.072 56 56 56h560c30.928 0 56-25.072 56-56V120c0-30.928-25.072-56-56-56H232z m0 840V120h560v784H232z m112-736h-64v64h64V168z m168 120c-123.712 0-224 100.288-224 224s100.288 224 224 224 224-100.288 224-224-100.288-224-224-224z m-168 224c0-92.784 75.216-168 168-168s168 75.216 168 168-75.216 168-168 168-168-75.216-168-168z m168-112c-61.856 0-112 50.144-112 112s50.144 112 112 112 112-50.144 112-112-50.144-112-112-112zM744 168h-64v64h64V168zM316 792v56h392v-56H316z" Fill="{DynamicResource Global.Foreground}" />

                        </Viewbox>
                    </Border>
                    <Viewbox
                        Height="14"
                        Margin="3"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Bottom">
                        <Path RenderTransformOrigin="0.5,0.5">
                            <Path.RenderTransform>
                                <RotateTransform CenterX="0" CenterY="0" />
                            </Path.RenderTransform>
                            <Path.Style>
                                <Style TargetType="Path">
                                    <Setter Property="Visibility" Value="Hidden" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding ScanStatus}" Value="Scanning">
                                            <DataTrigger.EnterActions>
                                                <BeginStoryboard>
                                                    <Storyboard>
                                                        <DoubleAnimation
                                                            RepeatBehavior="Forever"
                                                            Storyboard.TargetProperty="RenderTransform.Angle"
                                                            From="0"
                                                            To="360"
                                                            Duration="0:0:1" />
                                                    </Storyboard>
                                                </BeginStoryboard>
                                            </DataTrigger.EnterActions>
                                            <DataTrigger.ExitActions>
                                                <BeginStoryboard>
                                                    <Storyboard>
                                                        <DoubleAnimation
                                                            Storyboard.TargetProperty="RenderTransform.Angle"
                                                            To="0"
                                                            Duration="0:0:0" />
                                                    </Storyboard>
                                                </BeginStoryboard>
                                            </DataTrigger.ExitActions>
                                            <Setter Property="Visibility" Value="Visible" />
                                            <Setter Property="Fill" Value="{DynamicResource Common.HighLight.Hover.Background}" />
                                            <Setter Property="Data" Value="M171.292444 548.977778a337.464889 337.464889 0 0 1 210.488889-367.445334c111.616-43.52 231.992889-22.698667 317.212445 39.480889L626.460444 338.488889l325.233778-1.251556L835.470222 0l-59.562666 96.426667C650.353778 15.075556 479.175111-11.491556 329.272889 46.933333 121.628444 127.886222 2.048 337.351111 25.6 549.034667h145.635556zM852.764444 465.009778a337.464889 337.464889 0 0 1-210.488888 367.502222c-102.627556 39.992889-215.836444 24.917333-302.819556-29.013333l65.536-106.211556-349.752889-20.48L203.093333 1024l62.065778-100.465778c125.553778 81.351111 279.608889 102.001778 429.511111 43.52 207.644444-80.952889 327.224889-290.304 303.616-502.044444h-145.635555z" />
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding ScanStatus}" Value="Complete">
                                            <Setter Property="Visibility" Value="Visible" />
                                            <Setter Property="Fill" Value="Green" />
                                            <Setter Property="Data" Value="M947.605 139.803c-15.766-15.763-39.836-14.107-57.1 0-133.71 109.263-541.798 419.618-541.798 419.618s-165.018-71.128-216.268-94.163c-20.338-9.14-41.328-15.766-57.101 0-15.763 15.763-15.763 41.326 0 57.087 0 0 242.992 244.252 244.157 245.415 8.052 8.052 18.652 11.867 29.212 11.693 10.554 0.175 21.154-3.64 29.211-11.693 1.159-1.163 427.18-428.238 569.686-570.87 15.759-15.772 15.768-41.324 0.001-57.087z m0 0" />
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding ScanStatus}" Value="None">
                                            <Setter Property="Visibility" Value="Hidden" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Path.Style>
                        </Path>

                    </Viewbox>

                    <Popup
                        x:Name="scanStatusPopup"
                        Width="350"
                        MaxHeight="600"
                        AllowsTransparency="True"
                        HorizontalOffset="-300"
                        Placement="Top"
                        PlacementTarget="{Binding ElementName=msgScan}"
                        PopupAnimation="Fade"
                        StaysOpen="True"
                        VerticalOffset="0">
                        <Grid Margin="5">
                            <Border
                                Margin="5"
                                Background="{DynamicResource Menu.Background}"
                                CornerRadius="0 0 5 5"
                                Effect="{StaticResource PopupDropShadowEffect}" />
                            <Grid Margin="5">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>
                                <Grid
                                    Grid.Row="0"
                                    Height="35"
                                    Background="{DynamicResource Window.Title.Background}">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="auto" />
                                        <ColumnDefinition Width="auto" />
                                    </Grid.ColumnDefinitions>

                                    <TextBlock
                                        Margin="10,0"
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Center"
                                        Style="{StaticResource BaseTextBlock}"
                                        Text="扫描任务" />

                                    <Border
                                        Grid.Column="1"
                                        Margin="0"
                                        MouseLeftButtonUp="ClearScanTasks"
                                        Style="{StaticResource ToolsBarBorderStyle}">

                                        <Viewbox Width="15" Height="15">
                                            <Path
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                Data="M187.118702 146.498562l771.355932 0.002047v60.796667l-771.355932-0.002046v-60.796668z m0 222.286666l771.355932 0.002046v60.796668l-771.355932-0.002047v-60.796667z m0 224.186945l406.576948 0.001023v60.796668l-406.576948-0.001023v-60.796668z m0 222.286666l406.576948 0.001023v60.796668l-406.576948-0.001024v-60.796667zM65.525366 146.497539h60.796668v60.796668H65.525366v-60.796668z m0 222.287689h60.796668v60.796667H65.525366v-60.796667z m0 224.186945h60.796668v60.796668H65.525366v-60.796668z m0 222.286666h60.796668v60.796667H65.525366v-60.796667z m873.494171 4.916986l-85.97614-85.97614 85.97614-85.976141-57.326637-57.326636-85.97614 85.97614-85.97614-85.97614-57.325613 57.325613 85.97614 85.97614-85.97614 85.97614 57.325613 57.326637 85.97614-85.97614 85.977164 85.97614"
                                                Fill="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}" />
                                        </Viewbox>
                                    </Border>
                                    <Border
                                        Grid.Column="2"
                                        Margin="5,0"
                                        MouseLeftButtonUp="HideScanPopup"
                                        Style="{StaticResource ToolsBarBorderStyle}">

                                        <Viewbox
                                            Width="15"
                                            Height="15"
                                            RenderTransformOrigin="0.5,0.5">
                                            <Viewbox.RenderTransform>
                                                <RotateTransform Angle="90" />
                                            </Viewbox.RenderTransform>
                                            <Path
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                Data="M312.889 995.556c-17.067 0-28.445-5.69-39.822-17.067-22.756-22.756-17.067-56.889 5.689-79.645L642.844 568.89c11.378-11.378 17.067-22.756 17.067-34.133 0-11.378-5.689-22.756-17.067-34.134L273.067 187.733c-22.756-22.755-28.445-56.889-5.69-79.644 22.756-22.756 56.89-28.445 79.645-5.689l364.09 312.889C745.243 443.733 768 489.244 768 534.756s-17.067 85.333-51.2 119.466L352.711 984.178c-11.378 5.689-28.444 11.378-39.822 11.378z"
                                                Fill="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}" />
                                        </Viewbox>
                                    </Border>


                                </Grid>

                                <ScrollViewer
                                    Grid.Row="1"
                                    Margin="10"
                                    HorizontalScrollBarVisibility="Hidden"
                                    VerticalScrollBarVisibility="Auto">
                                    <ItemsControl ItemsSource="{Binding ScanTasks}">

                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Grid Name="rootGrid">
                                                    <Border
                                                        Margin="5"
                                                        Background="{DynamicResource Menu.Background}"
                                                        CornerRadius="0 0 5 5"
                                                        Effect="{StaticResource PopupDropShadowEffect}" />
                                                    <Grid Margin="5">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="auto" />
                                                            <ColumnDefinition Width="*" />
                                                            <ColumnDefinition Width="auto" />
                                                        </Grid.ColumnDefinitions>
                                                        <Viewbox
                                                            Grid.Column="0"
                                                            Width="25"
                                                            Margin="10"
                                                            HorizontalAlignment="Center"
                                                            VerticalAlignment="Center">
                                                            <Path RenderTransformOrigin="0.5,0.5">
                                                                <Path.RenderTransform>
                                                                    <RotateTransform x:Name="transform" Angle="0" CenterX="0" CenterY="0" />

                                                                </Path.RenderTransform>
                                                                <Path.Style>
                                                                    <Style TargetType="Path">
                                                                        <Style.Triggers>
                                                                            <DataTrigger Binding="{Binding Status, Mode=OneWay}" Value="Running">

                                                                                <Setter Property="Fill" Value="{DynamicResource Common.HighLight.Hover.Background}" />
                                                                                <Setter Property="Data" Value="M171.292444 548.977778a337.464889 337.464889 0 0 1 210.488889-367.445334c111.616-43.52 231.992889-22.698667 317.212445 39.480889L626.460444 338.488889l325.233778-1.251556L835.470222 0l-59.562666 96.426667C650.353778 15.075556 479.175111-11.491556 329.272889 46.933333 121.628444 127.886222 2.048 337.351111 25.6 549.034667h145.635556zM852.764444 465.009778a337.464889 337.464889 0 0 1-210.488888 367.502222c-102.627556 39.992889-215.836444 24.917333-302.819556-29.013333l65.536-106.211556-349.752889-20.48L203.093333 1024l62.065778-100.465778c125.553778 81.351111 279.608889 102.001778 429.511111 43.52 207.644444-80.952889 327.224889-290.304 303.616-502.044444h-145.635555z" />
                                                                            </DataTrigger>
                                                                            <DataTrigger Binding="{Binding Status}" Value="RanToCompletion">

                                                                                <Setter Property="Fill" Value="Green" />
                                                                                <Setter Property="Data" Value="M947.605 139.803c-15.766-15.763-39.836-14.107-57.1 0-133.71 109.263-541.798 419.618-541.798 419.618s-165.018-71.128-216.268-94.163c-20.338-9.14-41.328-15.766-57.101 0-15.763 15.763-15.763 41.326 0 57.087 0 0 242.992 244.252 244.157 245.415 8.052 8.052 18.652 11.867 29.212 11.693 10.554 0.175 21.154-3.64 29.211-11.693 1.159-1.163 427.18-428.238 569.686-570.87 15.759-15.772 15.768-41.324 0.001-57.087z m0 0" />
                                                                            </DataTrigger>
                                                                            <DataTrigger Binding="{Binding Status}" Value="Canceled">

                                                                                <Setter Property="Fill" Value="Red" />
                                                                                <Setter Property="Data" Value="M610.218667 505.6l398.08-387.413333a49.664 49.664 0 0 0 0-71.338667l-2.133334-2.133333a52.992 52.992 0 0 0-73.301333 0L534.784 432.64 136.704 44.373333a52.992 52.992 0 0 0-73.386667 0L61.269333 46.592a48.810667 48.810667 0 0 0 0 71.338667l398.165334 387.669333-398.165334 387.498667a49.664 49.664 0 0 0 0 71.253333l2.218667 2.133333c20.48 19.626667 52.821333 19.626667 73.301333 0l398.08-387.413333 398.08 387.413333c20.48 19.626667 52.906667 19.626667 73.386667 0l2.048-2.133333a49.664 49.664 0 0 0 0-71.253333l-398.08-387.413334z" />
                                                                            </DataTrigger>
                                                                        </Style.Triggers>
                                                                    </Style>
                                                                </Path.Style>
                                                            </Path>

                                                        </Viewbox>

                                                        <StackPanel
                                                            Grid.Column="1"
                                                            Margin="5"
                                                            Orientation="Vertical">
                                                            <TextBlock Margin="5,10" Text="{Binding CreateTime}" />

                                                            <TextBlock Margin="5,10" Text="{Binding StatusText}" />

                                                        </StackPanel>
                                                        <StackPanel
                                                            Grid.Column="2"
                                                            Width="100"
                                                            VerticalAlignment="Center"
                                                            Orientation="Vertical">
                                                            <StackPanel.Style>
                                                                <Style TargetType="StackPanel">
                                                                    <Setter Property="Visibility" Value="Hidden" />

                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding ElementName=rootGrid, Path=IsMouseOver}" Value="True">
                                                                            <Setter Property="Visibility" Value="Visible" />
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </StackPanel.Style>
                                                            <Button
                                                                Click="CancelScanTask"
                                                                Content="取消"
                                                                IsEnabled="{Binding Running}"
                                                                Tag="{Binding CreateTime}" />
                                                            <Button
                                                                Click="ShowScanDetail"
                                                                Content="详情"
                                                                IsEnabled="{Binding Running, Converter={StaticResource OppositeBooleanConverter}}"
                                                                Tag="{Binding CreateTime}" />
                                                        </StackPanel>
                                                    </Grid>
                                                </Grid>

                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <StackPanel Orientation="Vertical" />
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>

                                    </ItemsControl>
                                </ScrollViewer>






                            </Grid>
                        </Grid>
                    </Popup>

                </Grid>
                <chao:PathMsg
                    Name="downloadPathMsg"
                    MsgCount="100"
                    Path="M942.545455 676.584727a34.909091 34.909091 0 0 1 34.90909 34.909091v139.636364c0 70.562909-57.437091 128-128 128h-674.90909a128.139636 128.139636 0 0 1-128-128v-139.636364a34.909091 34.909091 0 1 1 69.818181 0v139.636364c0 32.046545 26.088727 58.181818 58.181819 58.181818h674.90909c32.093091 0 58.181818-26.135273 58.181819-58.181818v-139.636364a34.909091 34.909091 0 0 1 34.909091-34.909091z m-455.214546 129.396364l-164.584727-164.561455a34.909091 34.909091 0 1 1 49.361454-49.361454l104.983273 104.96V81.454545a34.909091 34.909091 0 1 1 69.818182 0v615.563637l104.96-104.96a34.909091 34.909091 0 1 1 49.361454 49.361454l-164.538181 164.561455a34.792727 34.792727 0 0 1-24.669091 10.216727c-8.96 0-17.873455-3.397818-24.715637-10.216727z"
                    Style="{StaticResource NormalPathMsg}" />
                <chao:PathMsg
                    Name="msgPathMsg"
                    MouseLeftButtonUp="ShowMessage"
                    MsgCount="{Binding Message.Count}"
                    Path="M864 64H160C107.072 64 64 107.072 64 160v608c0 52.928 43.072 96 96 96h61.92v123.232L443.84 864H864c52.928 0 96-43.072 96-96V160c0-52.928-43.072-96-96-96z m32 704a32 32 0 0 1-32 32H443.84c-10.912 0-21.664 2.816-31.072 8.064l-126.88 70.4V864c0-35.296-28.704-64-64-64H160c-17.632 0-32-14.336-32-32V160c0-17.632 14.368-32 32-32h704c17.664 0 32 14.368 32 32v608z M640 520H256a32 32 0 1 0 0 64h384a32 32 0 1 0 0-64zM768 296H256a32 32 0 0 0 0 64h512a32 32 0 1 0 0-64z"
                    Style="{StaticResource NormalPathMsg}" />
            </StackPanel>


            <Popup
                x:Name="msgPopup"
                Width="350"
                MaxHeight="600"
                AllowsTransparency="True"
                HorizontalOffset="-300"
                Placement="Top"
                PlacementTarget="{Binding ElementName=msgPathMsg}"
                PopupAnimation="Fade"
                StaysOpen="True"
                VerticalOffset="0">
                <Grid Margin="5">
                    <Border
                        Margin="5"
                        Background="{DynamicResource Menu.Background}"
                        CornerRadius="0 0 5 5"
                        Effect="{StaticResource PopupDropShadowEffect}" />
                    <Grid Margin="5">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <Grid
                            Grid.Row="0"
                            Height="35"
                            Background="{DynamicResource Window.Title.Background}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="auto" />
                                <ColumnDefinition Width="auto" />
                            </Grid.ColumnDefinitions>

                            <TextBlock
                                Margin="10,0"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Center"
                                Style="{StaticResource BaseTextBlock}"
                                Text="最近消息" />

                            <Border
                                Grid.Column="1"
                                Margin="0"
                                MouseLeftButtonUp="ClearMsg"
                                Style="{StaticResource ToolsBarBorderStyle}">

                                <Viewbox Width="15" Height="15">
                                    <Path
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        Data="M187.118702 146.498562l771.355932 0.002047v60.796667l-771.355932-0.002046v-60.796668z m0 222.286666l771.355932 0.002046v60.796668l-771.355932-0.002047v-60.796667z m0 224.186945l406.576948 0.001023v60.796668l-406.576948-0.001023v-60.796668z m0 222.286666l406.576948 0.001023v60.796668l-406.576948-0.001024v-60.796667zM65.525366 146.497539h60.796668v60.796668H65.525366v-60.796668z m0 222.287689h60.796668v60.796667H65.525366v-60.796667z m0 224.186945h60.796668v60.796668H65.525366v-60.796668z m0 222.286666h60.796668v60.796667H65.525366v-60.796667z m873.494171 4.916986l-85.97614-85.97614 85.97614-85.976141-57.326637-57.326636-85.97614 85.97614-85.97614-85.97614-57.325613 57.325613 85.97614 85.97614-85.97614 85.97614 57.325613 57.326637 85.97614-85.97614 85.977164 85.97614"
                                        Fill="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}" />
                                </Viewbox>
                            </Border>
                            <Border
                                Grid.Column="2"
                                Margin="5,0"
                                MouseLeftButtonUp="HideMsgPopup"
                                Style="{StaticResource ToolsBarBorderStyle}">

                                <Viewbox
                                    Width="15"
                                    Height="15"
                                    RenderTransformOrigin="0.5,0.5">
                                    <Viewbox.RenderTransform>
                                        <RotateTransform x:Name="rotateTransform" Angle="90" />
                                    </Viewbox.RenderTransform>
                                    <Path
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        Data="M312.889 995.556c-17.067 0-28.445-5.69-39.822-17.067-22.756-22.756-17.067-56.889 5.689-79.645L642.844 568.89c11.378-11.378 17.067-22.756 17.067-34.133 0-11.378-5.689-22.756-17.067-34.134L273.067 187.733c-22.756-22.755-28.445-56.889-5.69-79.644 22.756-22.756 56.89-28.445 79.645-5.689l364.09 312.889C745.243 443.733 768 489.244 768 534.756s-17.067 85.333-51.2 119.466L352.711 984.178c-11.378 5.689-28.444 11.378-39.822 11.378z"
                                        Fill="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}" />
                                </Viewbox>
                            </Border>


                        </Grid>

                        <ScrollViewer
                            Grid.Row="1"
                            Margin="10"
                            HorizontalScrollBarVisibility="Hidden"
                            VerticalScrollBarVisibility="Auto">
                            <ItemsControl ItemsSource="{Binding Message}">

                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <chao:MessageCard
                                            Width="280"
                                            Height="80"
                                            Margin="0,10"
                                            Foreground="{DynamicResource Global.Foreground}"
                                            Message="{Binding Text}"
                                            MessageType="{Binding Type}" />
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <StackPanel Orientation="Vertical" />
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>

                            </ItemsControl>
                        </ScrollViewer>






                    </Grid>
                </Grid>
            </Popup>



        </Grid>
    </Grid>
</chao:BaseWindow>
